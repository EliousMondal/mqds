<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>MQDS: harmonic_bath Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MQDS
   &#160;<span id="projectnumber">0.0.1</span>
   </div>
   <div id="projectbrief">Molecular Quantum Dynamics and Spectroscopy</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">harmonic_bath Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Module to handle a harmonic-oscillator model for the bath in quantum dynamics simulations.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a41101d75ccfabb2e9f27f11decb6ef37"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a41101d75ccfabb2e9f27f11decb6ef37">initialize_bath</a></td></tr>
<tr class="memdesc:a41101d75ccfabb2e9f27f11decb6ef37"><td class="mdescLeft">&#160;</td><td class="mdescRight">Allocates the necessary arrays to describe the bath and system-bath interactions. Also, the spectral density is uniformly sampled according to frequency-dependent reorganization energy.  <a href="#a41101d75ccfabb2e9f27f11decb6ef37">More...</a><br /></td></tr>
<tr class="separator:a41101d75ccfabb2e9f27f11decb6ef37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a209ab4c6fcbee56d4130900dd03bde8d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a209ab4c6fcbee56d4130900dd03bde8d">sample_thermal_wigner</a> (x_init, p_init, beta)</td></tr>
<tr class="memdesc:a209ab4c6fcbee56d4130900dd03bde8d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sample the initial thermal distribution for harmonic bath from the Wigner transform of the Boltzmann operator. This is under the assumption that the full initil density operator can be written as \( \hat{\rho}_s\hat{\rho}_b^{eq} \).  <a href="#a209ab4c6fcbee56d4130900dd03bde8d">More...</a><br /></td></tr>
<tr class="separator:a209ab4c6fcbee56d4130900dd03bde8d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9311d6bb691d58fb89aa43ecd085b9d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a9311d6bb691d58fb89aa43ecd085b9d6">finalize_bath</a></td></tr>
<tr class="separator:a9311d6bb691d58fb89aa43ecd085b9d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22ca617dad70bf3ce86539b72b68bea3"><td class="memItemLeft" align="right" valign="top">real(dp) function, dimension(nbath *nosc)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a22ca617dad70bf3ce86539b72b68bea3">bilinear_harmonic_force_pldm</a> (x, x_map, p_map, xt_map, pt_map)</td></tr>
<tr class="memdesc:a22ca617dad70bf3ce86539b72b68bea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate bilinear coupling force for PLDM.  <a href="#a22ca617dad70bf3ce86539b72b68bea3">More...</a><br /></td></tr>
<tr class="separator:a22ca617dad70bf3ce86539b72b68bea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33a526cc5d5d3e0bf792ddf07af9b978"><td class="memItemLeft" align="right" valign="top">real(dp) function, dimension(nbath *nosc)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a33a526cc5d5d3e0bf792ddf07af9b978">bilinear_harmonic_force_twa</a> (x, x_map, p_map)</td></tr>
<tr class="memdesc:a33a526cc5d5d3e0bf792ddf07af9b978"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the bilinear coupling force for TWA and SQC calculations.  <a href="#a33a526cc5d5d3e0bf792ddf07af9b978">More...</a><br /></td></tr>
<tr class="separator:a33a526cc5d5d3e0bf792ddf07af9b978"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7eb91ccd3e5be0b3620f57cc2b3f5db7"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a7eb91ccd3e5be0b3620f57cc2b3f5db7">x_bath</a></td></tr>
<tr class="separator:a7eb91ccd3e5be0b3620f57cc2b3f5db7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae41673f415d22d3d276f35da0cafa627"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#ae41673f415d22d3d276f35da0cafa627">p_bath</a></td></tr>
<tr class="separator:ae41673f415d22d3d276f35da0cafa627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a7488b50828de3332bc2b7d12e423a3"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a7a7488b50828de3332bc2b7d12e423a3">omega</a></td></tr>
<tr class="separator:a7a7488b50828de3332bc2b7d12e423a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b017527879ae7f4788a9b6978e45d30"><td class="memItemLeft" align="right" valign="top">real(dp), dimension(:,:), allocatable&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespaceharmonic__bath.html#a2b017527879ae7f4788a9b6978e45d30">c</a></td></tr>
<tr class="separator:a2b017527879ae7f4788a9b6978e45d30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Module to handle a harmonic-oscillator model for the bath in quantum dynamics simulations. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a22ca617dad70bf3ce86539b72b68bea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22ca617dad70bf3ce86539b72b68bea3">&#9670;&nbsp;</a></span>bilinear_harmonic_force_pldm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function, dimension(nbath*nosc) harmonic_bath::bilinear_harmonic_force_pldm </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(nbath*nosc), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nstate), intent(in)&#160;</td>
          <td class="paramname"><em>x_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nstate), intent(in)&#160;</td>
          <td class="paramname"><em>p_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nstate), intent(in)&#160;</td>
          <td class="paramname"><em>xt_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nstate), intent(in)&#160;</td>
          <td class="paramname"><em>pt_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate bilinear coupling force for PLDM. </p>

</div>
</div>
<a id="a33a526cc5d5d3e0bf792ddf07af9b978"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a33a526cc5d5d3e0bf792ddf07af9b978">&#9670;&nbsp;</a></span>bilinear_harmonic_force_twa()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp) function, dimension(nbath*nosc) harmonic_bath::bilinear_harmonic_force_twa </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(nbath*nosc), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nstate), intent(in)&#160;</td>
          <td class="paramname"><em>x_map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nstate), intent(in)&#160;</td>
          <td class="paramname"><em>p_map</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the bilinear coupling force for TWA and SQC calculations. </p>

</div>
</div>
<a id="a9311d6bb691d58fb89aa43ecd085b9d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9311d6bb691d58fb89aa43ecd085b9d6">&#9670;&nbsp;</a></span>finalize_bath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine harmonic_bath::finalize_bath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a41101d75ccfabb2e9f27f11decb6ef37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41101d75ccfabb2e9f27f11decb6ef37">&#9670;&nbsp;</a></span>initialize_bath()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine harmonic_bath::initialize_bath </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Allocates the necessary arrays to describe the bath and system-bath interactions. Also, the spectral density is uniformly sampled according to frequency-dependent reorganization energy. </p>
<p>Note: This is restricted to a single range and discretization of frequencies (defined by a single dw)</p>
<p>Sample bath according to the method described by Wang et al JCP 110, 4828 (1999)</p>
<p>Writes a log of sampled modes into a file called "sampledbath.log" </p>

</div>
</div>
<a id="a209ab4c6fcbee56d4130900dd03bde8d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a209ab4c6fcbee56d4130900dd03bde8d">&#9670;&nbsp;</a></span>sample_thermal_wigner()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine harmonic_bath::sample_thermal_wigner </td>
          <td>(</td>
          <td class="paramtype">real(dp), dimension(nbath*nosc), intent(out)&#160;</td>
          <td class="paramname"><em>x_init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), dimension(nbath*nosc), intent(out)&#160;</td>
          <td class="paramname"><em>p_init</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real(dp), intent(in)&#160;</td>
          <td class="paramname"><em>beta</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Sample the initial thermal distribution for harmonic bath from the Wigner transform of the Boltzmann operator. This is under the assumption that the full initil density operator can be written as \( \hat{\rho}_s\hat{\rho}_b^{eq} \). </p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2b017527879ae7f4788a9b6978e45d30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b017527879ae7f4788a9b6978e45d30">&#9670;&nbsp;</a></span>c</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:,:), allocatable harmonic_bath::c</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7a7488b50828de3332bc2b7d12e423a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a7488b50828de3332bc2b7d12e423a3">&#9670;&nbsp;</a></span>omega</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), allocatable harmonic_bath::omega</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae41673f415d22d3d276f35da0cafa627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae41673f415d22d3d276f35da0cafa627">&#9670;&nbsp;</a></span>p_bath</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), allocatable harmonic_bath::p_bath</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7eb91ccd3e5be0b3620f57cc2b3f5db7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb91ccd3e5be0b3620f57cc2b3f5db7">&#9670;&nbsp;</a></span>x_bath</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real(dp), dimension(:), allocatable harmonic_bath::x_bath</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
